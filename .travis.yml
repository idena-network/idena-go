dist: xenial
language: go

os:
  - linux

env:
  - GO111MODULE=on

go:
  - 1.12.x

git:
  depth: 1

install:
  - go mod vendor

script:
  - go test -v ./...
  - mkdir builds && cd builds
  - go build -mod=vendor ../

deploy:
  provider: releases
  api_key: "$GH_TOKEN"
  file_glob: true
  file: builds/*
  skip_cleanup: true
  on:
    branches:
      only:
        - travis-releases